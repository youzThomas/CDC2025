:root {
	--space: #0c355c;
	--space-2: #0a2a49;
	--text: #e9f2ff;
	--muted: #c3d6f2;
	--panel: #0f3f6e99;
	--chip: #112b4a;
	--moon: #cfd4da;
	--moon-2: #9aa3ad;
	--earth-blue: #2b6cff;
	--earth-green: #48c774;
	--earth-cloud: #eef6ff;
	--accent: #5bd1ff;
	--shadow: 0 10px 30px rgba(0, 0, 0, 0.35);
}

/* Base */
* {
	box-sizing: border-box;
}
html,
body {
	height: 100%;
}
body {
	margin: 0;
	color: var(--text);
	background: radial-gradient(1200px 800px at 50% -10%, #123d6b 0%, var(--space) 40%, var(--space-2) 100%);
	font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, 'Apple Color Emoji',
		'Segoe UI Emoji';
	overflow-x: hidden;
}

/* Starfields */
.stars,
.stars2,
.stars3 {
	position: fixed;
	inset: 0;
	z-index: -1;
	pointer-events: none;
	background-repeat: repeat;
}
.stars {
	background-image: radial-gradient(2px 2px at 40px 60px, #fff 40%, transparent 41%),
		radial-gradient(2px 2px at 340px 120px, #fff 40%, transparent 41%),
		radial-gradient(1.5px 1.5px at 640px 300px, #fff 40%, transparent 41%),
		radial-gradient(1px 1px at 860px 500px, #fff 40%, transparent 41%);
	animation: twinkle 8s linear infinite;
}
.stars2 {
	opacity: 0.7;
	filter: blur(0.4px);
	background-image: radial-gradient(1.6px 1.6px at 140px 200px, #fff 40%, transparent 41%),
		radial-gradient(1.4px 1.4px at 540px 420px, #fff 40%, transparent 41%),
		radial-gradient(1.8px 1.8px at 940px 220px, #fff 40%, transparent 41%);
	animation: twinkle 10s linear infinite reverse;
}
.stars3 {
	opacity: 0.5;
	filter: blur(0.8px);
	background-image: radial-gradient(1.2px 1.2px at 240px 360px, #fff 40%, transparent 41%),
		radial-gradient(1.3px 1.3px at 780px 160px, #fff 40%, transparent 41%),
		radial-gradient(1.1px 1.1px at 1160px 560px, #fff 40%, transparent 41%);
	animation: twinkle 12s linear infinite;
}
@keyframes twinkle {
	0%,
	100% {
		opacity: 0.6;
	}
	50% {
		opacity: 1;
	}
}

/* Earth */
.earth {
	position: fixed;
	left: 50%;
	top: 46%;
	transform: translate(-50%, -50%);
	width: 240px;
	height: 240px;
	border-radius: 50%;
	box-shadow: 0 0 0 6px rgba(255, 255, 255, 0.06), 0 0 60px rgba(91, 209, 255, 0.25) inset;
	background: radial-gradient(circle at 65% 40%, var(--earth-cloud) 0 14%, transparent 15%),
		radial-gradient(circle at 20% 60%, var(--earth-green) 0 22%, transparent 23%),
		radial-gradient(circle at 40% 35%, var(--earth-green) 0 18%, transparent 19%),
		radial-gradient(circle at 70% 70%, var(--earth-green) 0 16%, transparent 17%),
		radial-gradient(circle at 50% 50%, var(--earth-blue) 0 100%);
	animation: drift 60s linear infinite;
}
@keyframes drift {
	from {
		transform: translate(-50%, -50%) rotate(0);
	}
	to {
		transform: translate(-50%, -50%) rotate(360deg);
	}
}

/* Moon ground */
.moon {
	position: fixed;
	left: 0;
	right: 0;
	bottom: -2px;
	height: 34vh;
	z-index: 0;
	background:
    /* maria patches */ radial-gradient(120px 80px at 35% 55%, rgba(50, 60, 70, 0.28) 0, transparent 70%),
		radial-gradient(200px 110px at 70% 60%, rgba(50, 60, 70, 0.22) 0, transparent 72%),
		radial-gradient(90px 60px at 20% 80%, rgba(50, 60, 70, 0.2) 0, transparent 70%),
		radial-gradient(160% 100% at 50% 10%, var(--moon) 0%, #b8c0c7 50%, #a8b1ba 100%);
	clip-path: ellipse(140% 100% at 50% 100%);
	border-top: 1px solid rgba(255, 255, 255, 0.08);
}
/* --- MOON CRATERS: dense, layered --- */
.craters {
	position: absolute;
	inset: 0;
	opacity: 0.95;
}

/* Back layer: large/medium craters */
.craters::before {
	content: '';
	position: absolute;
	left: 0;
	right: 0;
	bottom: 10%;
	height: 70%;
	opacity: 0.42;
	background:
    /* big ones */ radial-gradient(closest-side, rgba(135, 145, 155, 0.85) 0 62%, transparent 63%) 12% 78% /
			140px 60px no-repeat,
		radial-gradient(closest-side, rgba(135, 145, 155, 0.85) 0 62%, transparent 63%) 28% 84% / 110px 50px no-repeat,
		radial-gradient(closest-side, rgba(135, 145, 155, 0.85) 0 62%, transparent 63%) 44% 76% / 160px 65px no-repeat,
		radial-gradient(closest-side, rgba(135, 145, 155, 0.85) 0 62%, transparent 63%) 66% 82% / 120px 54px no-repeat,
		radial-gradient(closest-side, rgba(135, 145, 155, 0.85) 0 62%, transparent 63%) 84% 74% / 130px 58px no-repeat,
		/* medium */ radial-gradient(closest-side, rgba(145, 155, 165, 0.75) 0 62%, transparent 63%) 19% 70% / 90px 42px
			no-repeat,
		radial-gradient(closest-side, rgba(145, 155, 165, 0.75) 0 62%, transparent 63%) 35% 86% / 86px 38px no-repeat,
		radial-gradient(closest-side, rgba(145, 155, 165, 0.75) 0 62%, transparent 63%) 58% 74% / 96px 44px no-repeat,
		radial-gradient(closest-side, rgba(145, 155, 165, 0.75) 0 62%, transparent 63%) 73% 88% / 88px 40px no-repeat,
		radial-gradient(closest-side, rgba(145, 155, 165, 0.75) 0 62%, transparent 63%) 90% 82% / 92px 42px no-repeat;
	filter: blur(0.2px);
}

/* Front layer: many small craters + faint rims */
.craters::after {
	content: '';
	position: absolute;
	left: 0;
	right: 0;
	bottom: 8%;
	height: 72%;
	opacity: 0.55;
	background:
    /* small cluster left */ radial-gradient(closest-side, rgba(150, 160, 170, 0.7) 0 60%, transparent 61%)
			9% 75% / 42px 20px no-repeat,
		radial-gradient(closest-side, rgba(150, 160, 170, 0.7) 0 60%, transparent 61%) 13% 82% / 34px 16px no-repeat,
		radial-gradient(closest-side, rgba(150, 160, 170, 0.7) 0 60%, transparent 61%) 16% 76% / 28px 14px no-repeat,
		/* mid cluster */ radial-gradient(closest-side, rgba(150, 160, 170, 0.7) 0 60%, transparent 61%) 38% 80% / 40px 18px
			no-repeat,
		radial-gradient(closest-side, rgba(150, 160, 170, 0.7) 0 60%, transparent 61%) 41% 86% / 32px 16px no-repeat,
		radial-gradient(closest-side, rgba(150, 160, 170, 0.7) 0 60%, transparent 61%) 47% 78% / 30px 14px no-repeat,
		/* right cluster */ radial-gradient(closest-side, rgba(150, 160, 170, 0.7) 0 60%, transparent 61%) 72% 84% / 44px
			20px no-repeat,
		radial-gradient(closest-side, rgba(150, 160, 170, 0.7) 0 60%, transparent 61%) 78% 78% / 34px 16px no-repeat,
		radial-gradient(closest-side, rgba(150, 160, 170, 0.7) 0 60%, transparent 61%) 86% 88% / 36px 18px no-repeat,
		/* scattered */ radial-gradient(closest-side, rgba(155, 165, 175, 0.6) 0 60%, transparent 61%) 24% 90% / 26px 12px
			no-repeat,
		radial-gradient(closest-side, rgba(155, 165, 175, 0.6) 0 60%, transparent 61%) 56% 90% / 22px 10px no-repeat,
		radial-gradient(closest-side, rgba(155, 165, 175, 0.6) 0 60%, transparent 61%) 64% 76% / 24px 12px no-repeat,
		radial-gradient(closest-side, rgba(155, 165, 175, 0.6) 0 60%, transparent 61%) 91% 74% / 24px 12px no-repeat;
	/* subtle rim highlights (inner shadow illusion) */
	box-shadow: inset 0 16px 30px rgba(0, 0, 0, 0.08);
	filter: drop-shadow(0 2px 0 rgba(0, 0, 0, 0.08));
}

/* Minimap */
#minimap {
	position: fixed;
	right: 14px;
	top: 76px;
	width: 120px;
	height: 120px;
	z-index: 10;
	cursor: pointer;
	filter: drop-shadow(0 6px 18px rgba(0, 0, 0, 0.35));
}
#minimap .dot {
	fill: #ffbf3f;
	stroke: #10243d;
	stroke-width: 0.6;
}

/* Nav & panels */
.nav {
	position: fixed;
	inset: 0 0 auto 0;
	height: 64px;
	display: flex;
	gap: 12px;
	align-items: center;
	justify-content: center;
	z-index: 50;
	backdrop-filter: blur(6px);
	background: linear-gradient(180deg, rgba(7, 20, 38, 0.75), rgba(7, 20, 38, 0.35));
	border-bottom: 1px solid rgba(255, 255, 255, 0.08);
}
.brand {
	position: absolute;
	left: 16px;
	font-weight: 800;
	letter-spacing: 0.4px;
}
.chip {
	padding: 10px 14px;
	border-radius: 999px;
	background: var(--chip);
	color: var(--muted);
	border: 1px solid rgba(255, 255, 255, 0.08);
	cursor: pointer;
	user-select: none;
	transition: transform 0.12s ease, background 0.2s;
	box-shadow: var(--shadow);
}
.chip:hover {
	transform: translateY(-2px);
	background: #0e355e;
}
.chip.active {
	background: linear-gradient(180deg, #164c85, #0f3f6e);
	color: #fff;
}

.scene {
	position: relative;
	min-height: 100vh;
	padding-top: 84px;
}
.wrapper {
	position: relative;
	z-index: 1;
	max-width: 1100px;
	margin: 0 auto;
	padding: 120px 24px 40vh;
	display: grid;
	gap: 28px;
}
.panel {
	background: var(--panel);
	border: 1px solid rgba(255, 255, 255, 0.1);
	border-radius: 18px;
	padding: 24px;
	backdrop-filter: blur(4px);
}
.panel h2 {
	margin: 0 0 8px;
}
.panel p {
	color: var(--muted);
	line-height: 1.6;
}

section {
	display: none;
}
section.active {
	display: block;
}

.row {
	display: flex;
	gap: 12px;
	flex-wrap: wrap;
}
.btn {
	background: #1d66cc;
	color: #fff;
	border: 0;
	padding: 10px 14px;
	border-radius: 12px;
	cursor: pointer;
	box-shadow: var(--shadow);
}
.btn:disabled {
	opacity: 0.6;
	cursor: not-allowed;
}
select,
input[type='file'] {
	background: #0e2a47;
	color: #eaf3ff;
	border: 1px solid rgba(255, 255, 255, 0.15);
	padding: 10px 12px;
	border-radius: 10px;
}

/* Canvas */
canvas {
	background: rgba(10, 20, 35, 0.35);
	border-radius: 12px;
	width: 100%;
	max-height: 420px;
}

/* Chat */
.panel-header {
	display: flex;
	flex-direction: column;
	gap: 4px;
	margin-bottom: 16px;
}
.panel-subtitle {
	margin: 0;
	color: var(--muted);
	font-size: 0.95rem;
}
.chat-shell {
	position: relative;
	background: linear-gradient(180deg, rgba(12, 43, 75, 0.6), rgba(8, 29, 50, 0.4));
	border: 1px solid rgba(255, 255, 255, 0.14);
	border-radius: 16px;
	height: clamp(320px, 45vh, 420px);
	padding: 18px;
	box-shadow: var(--shadow);
	overflow: hidden;
}
.chat-log {
	height: 100%;
	padding-right: 6px;
	overflow-y: auto;
	display: flex;
	flex-direction: column;
	gap: 14px;
}
.chat-message {
	display: grid;
	grid-template-columns: auto 1fr;
	gap: 10px;
	align-items: flex-start;
	align-self: flex-start;
	max-width: min(100%, 640px);
}
.chat-message.bot {
	align-self: flex-start;
}
.chat-message .bubble {
	background: rgba(12, 35, 59, 0.75);
	border: 1px solid rgba(255, 255, 255, 0.12);
	border-radius: 16px;
	padding: 12px 14px;
	line-height: 1.55;
	box-shadow: 0 12px 30px rgba(4, 16, 32, 0.45);
}

.chat-message.user {
	grid-template-columns: 1fr auto;
	align-self: flex-end;
	justify-items: end;
}
.chat-message.user .bubble {
	background: rgba(26, 88, 168, 0.82);
}
.chat-message.user .avatar {
	order: 2;
}
.chat-message .avatar {
	width: 34px;
	height: 34px;
	border-radius: 50%;
	background: rgba(24, 44, 74, 0.75);
	display: grid;
	place-items: center;
	font-size: 18px;
}
.chat-message.bot .avatar {
	background: rgba(91, 209, 255, 0.18);
	color: #5bd1ff;
}
.chat-message.user .avatar {
	background: rgba(29, 102, 204, 0.22);
	color: #bbe0ff;
}
.chat-suggestions {
	display: flex;
	flex-wrap: wrap;
	gap: 10px;
	margin: 18px 0 14px;
}
.chat-suggestions .chip {
	background: rgba(16, 53, 96, 0.6);
	border-color: rgba(91, 209, 255, 0.25);
	box-shadow: none;
}
.chat-suggestions .chip:hover {
	background: rgba(26, 86, 150, 0.8);
}
.chat-input {
	display: flex;
	gap: 12px;
	align-items: flex-end;
	margin-top: 12px;
}
.chat-input textarea {
	flex: 1;
	min-height: 44px;
	max-height: 160px;
	padding: 12px 14px;
	border-radius: 14px;
	border: 1px solid rgba(255, 255, 255, 0.16);
	background: rgba(10, 34, 56, 0.8);
	color: var(--text);
	font: inherit;
	resize: vertical;
}
.chat-input textarea:focus {
	outline: 2px solid rgba(91, 209, 255, 0.45);
	outline-offset: 2px;
}
.chat-actions {
	display: flex;
	gap: 10px;
}
.btn-ghost {
	background: transparent;
	color: var(--muted);
	border: 1px solid rgba(255, 255, 255, 0.22);
	box-shadow: none;
}
.btn-ghost:hover {
	background: rgba(17, 43, 71, 0.65);
}
.chat-status {
	margin: 10px 0 0;
	font-size: 0.85rem;
	color: rgba(185, 207, 238, 0.85);
}
.sr-only {
	position: absolute;
	width: 1px;
	height: 1px;
	padding: 0;
	margin: -1px;
	overflow: hidden;
	clip: rect(0, 0, 0, 0);
	white-space: nowrap;
	border: 0;
}

/* Story */
#story.panel {
	padding: 42px 42px 48px;
}
.story-header {
	margin-bottom: 18px;
	display: flex;
	flex-direction: column;
	gap: 6px;
}
.story-header h1 {
	margin: 0;
}
.story-mission-title {
	margin: 0;
	font-size: 1.2rem;
	color: #e2efff;
}
.story-header p {
	margin: 0;
	color: var(--muted);
}
.story-layout {
	display: grid;
	grid-template-columns: minmax(180px, 220px) 1fr;
	gap: 24px;
	align-items: start;
	position: relative;
}
.story-roster {
	background: rgba(10, 31, 52, 0.75);
	border: 1px solid rgba(255, 255, 255, 0.12);
	border-radius: 16px;
	padding: 18px;
	box-shadow: var(--shadow);
	min-height: 280px;
}
.story-roster h2 {
	margin: 0 0 12px;
	font-size: 1.05rem;
	letter-spacing: 0.4px;
}
.story-roster ul {
	list-style: none;
	margin: 0;
	padding: 0;
	display: flex;
	flex-direction: column;
	gap: 10px;
}
.story-roster li {
	padding: 10px 12px;
	border-radius: 12px;
	background: rgba(18, 54, 94, 0.55);
	border: 1px solid rgba(91, 209, 255, 0.2);
	font-size: 0.95rem;
	line-height: 1.4;
}
.story-roster li strong {
	display: block;
	color: #fff;
}
.story-roster li span {
	color: var(--muted);
	font-size: 0.82rem;
}
.story-cards {
	position: relative;
	display: grid;
	gap: 18px;
	grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
}
.story-card {
	position: relative;
	padding: 18px 18px 20px 18px;
	border-radius: 18px;
	background: rgba(11, 32, 56, 0.78);
	border: 1px solid rgba(255, 255, 255, 0.14);
	box-shadow: 0 20px 40px rgba(0, 0, 0, 0.35);
	min-height: 180px;
}
.story-card::after {
	content: '';
	position: absolute;
	inset: 0;
	border-radius: inherit;
	border: 1px solid rgba(91, 209, 255, 0.18);
	mask: linear-gradient(180deg, rgba(255, 255, 255, 0.32), transparent 65%);
	pointer-events: none;
}
.story-card header {
	display: flex;
	align-items: center;
	gap: 12px;
	margin-bottom: 12px;
}
.story-card img {
	width: 52px;
	height: 52px;
	border-radius: 14px;
	object-fit: cover;
	border: 2px solid rgba(91, 209, 255, 0.4);
	box-shadow: 0 6px 18px rgba(0, 0, 0, 0.28);
}
.story-card h3 {
	margin: 0;
	font-size: 1.05rem;
}
.story-role {
	margin: 4px 0 0;
	color: rgba(202, 219, 240, 0.85);
	font-size: 0.85rem;
}
.story-card p {
	margin: 0;
	color: var(--muted);
	line-height: 1.5;
}
.story-card footer {
	margin-top: 16px;
	font-size: 0.82rem;
	color: rgba(187, 221, 255, 0.8);
}
.story-empty {
	font-size: 0.95rem;
	color: rgba(193, 212, 238, 0.85);
}

@media (max-width: 860px) {
	.story-layout {
		grid-template-columns: 1fr;
	}
	.story-roster {
		position: sticky;
		top: 92px;
		z-index: 2;
	}
}

footer {
	position: fixed;
	right: 12px;
	bottom: 12px;
	font-size: 12px;
	opacity: 0.7;
}

/* Team Section */
#team {
	color: white;
	padding: 60px 20px;
	text-align: center;
}

.team-grid {
	display: grid;
	grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
	gap: 20px;
	margin-top: 40px;
}

.member {
	background: rgba(255, 255, 255, 0.08);
	border: 1px solid rgba(255, 255, 255, 0.2);
	border-radius: 12px;
	padding: 20px;
	font-size: 1.2em;
	font-weight: bold;
	transition: transform 0.2s ease, background 0.2s ease;
}

.member:hover {
	transform: translateY(-6px);
	background: rgba(255, 255, 255, 0.15);
}

/* Story section */
#story {
	position: relative;
	padding: 80px 20px;
	color: white;
	min-height: 60vh;
}

/* Minimap: global background element */
.minimap {
	position: fixed; /* stays in corner of screen */
	top: 70px; /* below the nav bar */
	right: 20px;
	width: 150px;
	height: 150px;
	border-radius: 50%;
	background: radial-gradient(circle at 30% 30%, #bbb, #888);
	overflow: hidden;
	border: 2px solid #fff;
	box-shadow: 0 0 10px rgba(255, 255, 255, 0.6);
	z-index: 5; /* above background, below nav */
}

.hidden {
	display: none;
}

.map-dot {
	position: absolute;
	width: 12px;
	height: 12px;
	background: #000;
	border-radius: 50%;
	cursor: pointer;
	border: 1px solid #fff;
	transition: transform 0.2s ease;
}

.map-dot:hover {
	transform: scale(1.3);
}
.map-dot.active {
	transform: scale(1.4);
	background: #5bd1ff;
	box-shadow: 0 0 12px rgba(91, 209, 255, 0.6);
}

/* Assessment progress */
.progress {
	width: 100%;
	height: 10px;
	background: rgba(255, 255, 255, 0.12);
	border-radius: 999px;
	overflow: hidden;
	margin: 8px 0 6px;
}
.progress-fill {
	height: 100%;
	background: linear-gradient(90deg, #5bd1ff, #2b6cff);
	transition: width 0.25s ease;
}
.progress-meta {
	display: flex;
	justify-content: space-between;
	font-size: 12px;
	opacity: 0.8;
	margin-bottom: 8px;
}

/* Bot log bubbles reuse .messages/.msg/.bot/.me from your theme */

/* Choice buttons: already .btn; add a pill style variant if you like */
.pill {
	border-radius: 999px;
	padding: 10px 14px;
	border: 1px solid rgba(255, 255, 255, 0.15);
	background: #0e2a47;
	color: #eaf3ff;
}
.pill:hover {
	background: #12365c;
}

/* Result card */
.result-card {
	margin-top: 16px;
	padding: 16px;
	border-radius: 16px;
	background: rgba(255, 255, 255, 0.06);
	border: 1px solid rgba(255, 255, 255, 0.15);
}
.result-card h3 {
	margin: 0 0 8px;
}
.result-grid {
	display: grid;
	gap: 12px;
	grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
}
.result-card ul {
	margin: 6px 0 0 18px;
}
